/* ===============================
   GLOBAL APP THEME (aligned with loading screen)
   =============================== */

:root {
    --app-bg-1: #d5eef4;
    --app-bg-2: #c6e6ef;
    --app-bg-3: #e2edf7;
    --app-bar-1: #0f3f55;
    --app-bar-2: #082d40;
    --app-bar-border: rgba(181, 231, 244, 0.22);
    --app-bar-text: #f6fcff;
    --app-bar-text-active: #86e3fb;
    --app-surface-bg: rgba(252, 255, 255, 0.78);
    --app-surface-border: rgba(18, 78, 103, 0.16);
    --app-surface-text: #0d2d42;
    --f7-bars-bg-color: #0b344a;
    --f7-navbar-bg-color: #0b344a;
    --f7-toolbar-bg-color: #0b344a;
    --f7-bars-text-color: #e7f6ff;
    --f7-bars-link-color: #e7f6ff;
    --f7-touch-ripple-color: rgba(231, 246, 255, 0.2);
    --f7-tabbar-link-inactive-color: #f6fcff;
    --f7-tabbar-link-active-color: #86e3fb;
    --app-bar-height-fluid: clamp(50px, 7.4vh, 64px);
    --app-title-size-fluid: clamp(14px, 2.7vh, 19px);
    --app-tab-label-size-fluid: clamp(11px, 1.7vh, 13px);
    --app-profile-btn-size-fluid: clamp(38px, 7.2vh, 52px);
    --app-profile-icon-size-fluid: clamp(22px, 4.8vh, 32px);
}

/* Framework7 page surfaces */
.view,
.views,
.page,
.page-content {
    background:
        radial-gradient(circle at 15% 14%, rgba(122, 210, 226, 0.24), transparent 32%),
        radial-gradient(circle at 88% 82%, rgba(91, 234, 212, 0.15), transparent 34%),
        linear-gradient(165deg, var(--app-bg-1) 0%, var(--app-bg-2) 45%, var(--app-bg-3) 100%);
}

/* Top bar */
.navbar-bg,
.ios .navbar-bg,
.md .navbar-bg {
    background: linear-gradient(145deg, var(--app-bar-1), var(--app-bar-2)) !important;
}

.navbar,
.navbar a,
.navbar .title {
    color: #e7f6ff !important;
}

/* Bottom tab bar */
.toolbar.tabbar,
.toolbar-bottom {
    background: linear-gradient(145deg, var(--app-bar-1), var(--app-bar-2)) !important;
    border-top: 1px solid var(--app-bar-border) !important;
}

/* iOS adds extra overlay layers for bars; force same dark gradient there too */
.ios .navbar,
.ios .toolbar,
.ios .toolbar-bottom,
.ios .toolbar.tabbar,
.ios .navbar-bg,
.ios .toolbar-bg {
    background: linear-gradient(145deg, var(--app-bar-1), var(--app-bar-2)) !important;
}

.ios .navbar::before,
.ios .navbar::after,
.ios .toolbar::before,
.ios .toolbar::after,
.ios .toolbar-bottom::before,
.ios .toolbar-bottom::after,
.ios .toolbar.tabbar::before,
.ios .toolbar.tabbar::after {
    background: linear-gradient(145deg, var(--app-bar-1), var(--app-bar-2)) !important;
    border-color: transparent !important;
}

.ios .safe-area-top,
.ios .safe-area-bottom {
    background: linear-gradient(145deg, var(--app-bar-1), var(--app-bar-2)) !important;
}

.tabbar .link {
    color: var(--app-bar-text) !important;
    opacity: 1 !important;
    text-shadow: 0 1px 2px rgba(2, 10, 18, 0.45);
}

.tabbar .link.tab-link-active,
.tabbar .link.tab-link-active i,
.tabbar .link.tab-link-active span {
    color: var(--app-bar-text-active) !important;
}

.tabbar .link i,
.tabbar-label,
.toolbar .link span {
    color: inherit !important;
}

.toolbar.tabbar .tabbar-label,
.toolbar-bottom .tabbar-label,
.tabbar .link .tabbar-label {
    color: var(--app-bar-text) !important;
    opacity: 1 !important;
    text-shadow: 0 1px 2px rgba(2, 10, 18, 0.45);
}

.tabbar .link:not(.tab-link-active) i,
.tabbar .link:not(.tab-link-active) .tabbar-label {
    opacity: 1 !important;
}

.tabbar-label,
.toolbar .link span {
    font-weight: 600;
}

.toolbar.tabbar .tab-link-active .tabbar-label,
.toolbar-bottom .tab-link-active .tabbar-label,
.tabbar .link.tab-link-active .tabbar-label {
    color: var(--app-bar-text-active) !important;
}

/* Smooth compact mode for short viewports (landscape phones, low-height windows) */
.navbar,
.toolbar.tabbar,
.toolbar-bottom {
    min-height: var(--app-bar-height-fluid) !important;
    height: var(--app-bar-height-fluid) !important;
    transition: min-height 240ms ease, height 240ms ease, padding 240ms ease;
}

.navbar-inner,
.toolbar-inner {
    min-height: var(--app-bar-height-fluid) !important;
    transition: min-height 240ms ease, padding 240ms ease;
}

.navbar .title,
.navbar .title.sudoku-title-centered {
    font-size: var(--app-title-size-fluid) !important;
    transition: font-size 240ms ease, padding 240ms ease;
}

.tabbar .link i {
    font-size: clamp(15px, 2.8vh, 21px) !important;
    line-height: 1 !important;
    margin-bottom: 0 !important;
    transition: font-size 240ms ease, opacity 220ms ease, transform 220ms ease, height 220ms ease;
}

.tabbar-label,
.toolbar .link span {
    font-size: var(--app-tab-label-size-fluid) !important;
    transition: font-size 240ms ease, transform 220ms ease, opacity 220ms ease;
}

.toolbar.tabbar .link,
.toolbar-bottom .link {
    min-height: 100%;
    padding-top: 3px;
    padding-bottom: 3px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 2px;
    transition: padding 240ms ease, gap 240ms ease;
}

.toolbar.tabbar .tabbar-label,
.toolbar-bottom .tabbar-label {
    display: block;
    line-height: 1.15;
    white-space: nowrap;
    overflow: visible;
    opacity: 1;
    max-height: none;
    margin-top: 0;
}

/* Content surfaces (cards/blocks/lists) */
.block-strong,
.ios .block-strong,
.md .block-strong,
.list.inset,
.list.strong,
.card {
    background: var(--app-surface-bg) !important;
    border: 1px solid var(--app-surface-border) !important;
    color: var(--app-surface-text);
    box-shadow: 0 10px 26px rgba(12, 46, 62, 0.12);
    backdrop-filter: blur(2px);
}

.item-title,
.item-after,
.list .item-inner,
.block strong,
.block b,
.block,
.block-footer {
    color: var(--app-surface-text);
}

/* ===============================
   FORCE BIG PROFILE BUTTON
   =============================== */

/* Link selbst */
.navbar .right a.profile-btn {
    width: var(--app-profile-btn-size-fluid) !important;
    height: var(--app-profile-btn-size-fluid) !important;
    min-width: var(--app-profile-btn-size-fluid) !important;
    min-height: var(--app-profile-btn-size-fluid) !important;
    padding: 0 !important;

    display: flex !important;
    align-items: center !important;
    justify-content: center !important;

    position: relative !important;
    border-radius: 999px;
    background: transparent !important;
    box-shadow: none !important;
}

/* Framework7 ICON FONT explizit überschreiben */
.navbar .right a.profile-btn i.f7-icons {
    font-size: var(--app-profile-icon-size-fluid) !important;
    /* <-- HIER wird er sichtbar groß */
    line-height: 1 !important;
    color: #e7f6ff !important;
    transition: font-size 240ms ease;
}

/* iOS link active/highlight layer can look white - force dark state */
/* Keep nav buttons merged with dark top bar (no white pills on iOS) */
.navbar .left a.link,
.navbar .right a.link {
    background: transparent !important;
    box-shadow: none !important;
}

.ios .navbar .left a.link:active,
.ios .navbar .left a.link.link-active,
.ios .navbar .right a.link:active,
.ios .navbar .right a.link.link-active {
    background: transparent !important;
}

.ios .navbar .left a.link::after,
.ios .navbar .left a.link::before,
.ios .navbar .right a.link::after,
.ios .navbar .right a.link::before {
    display: none !important;
}

.navbar .left a.link .icon,
.navbar .left a.link i,
.navbar .right a.link .icon,
.navbar .right a.link i {
    background: transparent !important;
    box-shadow: none !important;
    color: #e7f6ff !important;
}

.ios .navbar .left a.link.icon-only,
.ios .navbar .right a.link.icon-only {
    background: transparent !important;
    border-radius: 999px;
}

/* Status-Punkt */
.navbar .right a.profile-btn .profile-btn__dot {
    position: absolute !important;
    top: 6px !important;
    right: 6px !important;
    width: 9px !important;
    height: 9px !important;
    border-radius: 999px !important;
    background: var(--f7-color-green) !important;
}

.navbar .right a.profile-btn .profile-btn__dot.online {
    background: var(--f7-color-green) !important;
}

.navbar .right a.profile-btn .profile-btn__dot.offline {
    background: #9ca3af !important;
}


/* Freunde-Tab: Badge als heller Punkt am Icon */
.tabbar .link.friends-tab {
    position: relative;
}

.tabbar .link.friends-tab .badge {
    position: absolute;
    top: 6px;
    left: calc(50% + 8px);
    width: 8px;
    height: 8px;
    min-width: 8px;
    padding: 0;
    border-radius: 999px;
    background: #fca5a5;
    font-size: 0;
    box-shadow: 0 0 0 2px var(--f7-toolbar-bg-color);
}

/* Sudoku-Header: Titel exakt zentrieren */
.navbar .title.sudoku-title-centered {
    position: absolute;
    left: 0;
    right: 0;
    width: 100%;
    text-align: center;
    padding: 0 56px;
    box-sizing: border-box;
    pointer-events: none;
}

@media (max-height: 560px) {
    :root {
        --app-bar-height-fluid: clamp(38px, 7.2vh, 45px);
        --app-title-size-fluid: clamp(13px, 2.4vh, 16px);
        --app-tab-label-size-fluid: clamp(10px, 1.9vh, 12px);
        --app-profile-btn-size-fluid: clamp(32px, 6vh, 40px);
        --app-profile-icon-size-fluid: clamp(18px, 3.8vh, 24px);
    }

    .toolbar.tabbar .tabbar-label,
    .toolbar-bottom .tabbar-label {
        display: none !important;
    }
}

@media (max-height: 460px) {
    :root {
        --app-bar-height-fluid: clamp(34px, 6.2vh, 38px);
        --app-title-size-fluid: clamp(12px, 2.1vh, 14px);
        --app-profile-btn-size-fluid: clamp(30px, 5.6vh, 34px);
        --app-profile-icon-size-fluid: clamp(16px, 3.2vh, 20px);
    }

    .toolbar.tabbar .link i,
    .toolbar-bottom .link i {
        opacity: 1;
        transform: translateY(0) scale(1);
        font-size: clamp(15px, 3vh, 19px) !important;
        height: auto !important;
        margin: 0 !important;
        line-height: 1 !important;
    }

    .tabbar .link.friends-tab .badge {
        top: 3px;
    }
}

/* App Loading Screen */
.app-loading-screen {
    min-height: 100vh;
    display: grid;
    place-items: center;
    align-content: center;
    gap: 14px;
    padding: 24px;
    position: relative;
    overflow: hidden;
    background:
        radial-gradient(circle at 18% 18%, rgba(122, 210, 226, 0.32), transparent 34%),
        radial-gradient(circle at 82% 84%, rgba(91, 234, 212, 0.24), transparent 36%),
        linear-gradient(145deg, #1f5f75 0%, #083448 48%, #0f1c3e 100%);
    text-align: center;
}

.app-loading-screen__logo-image {
    width: 112px;
    height: 112px;
    border-radius: 24px;
    box-shadow:
        0 14px 34px rgba(7, 13, 29, 0.52),
        0 0 0 1px rgba(255, 255, 255, 0.12);
}

.app-loading-screen__logo {
    font-size: 34px;
    font-weight: 800;
    color: #ffffff;
    letter-spacing: 0.4px;
    text-shadow: 0 6px 24px rgba(20, 206, 255, 0.28);
}

.app-loading-screen__spinner {
    width: 34px;
    height: 34px;
    border-radius: 999px;
    border: 3px solid rgba(195, 233, 247, 0.34);
    border-top-color: #8fdd46;
    animation: spin 0.8s linear infinite;
}

.app-loading-screen__text {
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 1.1px;
    text-transform: uppercase;
    color: #e3f4ff;
    opacity: 0.95;
    padding: 6px 10px;
    border-radius: 999px;
    background: rgba(7, 18, 38, 0.28);
    border: 1px solid rgba(189, 233, 246, 0.25);
}

.app-loading-screen__glow {
    position: absolute;
    width: 240px;
    height: 240px;
    border-radius: 999px;
    filter: blur(30px);
    pointer-events: none;
}

.app-loading-screen__glow--left {
    top: -70px;
    left: -80px;
    background: rgba(120, 220, 235, 0.26);
}

.app-loading-screen__glow--right {
    bottom: -80px;
    right: -90px;
    background: rgba(102, 235, 183, 0.22);
}

/* Start Screen */
.start-screen-page .page-content {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100%;
    background:
        radial-gradient(circle at 18% 18%, rgba(122, 210, 226, 0.32), transparent 34%),
        radial-gradient(circle at 82% 84%, rgba(91, 234, 212, 0.24), transparent 36%),
        linear-gradient(145deg, #1f5f75 0%, #083448 48%, #0f1c3e 100%);
}

.start-screen {
    width: min(92vw, 430px);
    position: relative;
    padding: 10px;
}

.start-screen__card {
    margin: 0;
    border-radius: 24px;
    background: linear-gradient(165deg, rgba(235, 247, 252, 0.94), rgba(216, 235, 246, 0.93));
    border: 1px solid rgba(12, 64, 86, 0.18);
    box-shadow:
        0 24px 60px rgba(0, 0, 0, 0.35),
        inset 0 1px 0 rgba(255, 255, 255, 0.65);
    color: #15384d;
    backdrop-filter: blur(4px);
}

.start-screen__logo {
    width: 112px;
    height: 112px;
    border-radius: 24px;
    display: block;
    margin: 2px auto 14px;
    box-shadow:
        0 12px 30px rgba(7, 13, 29, 0.55),
        0 0 0 1px rgba(255, 255, 255, 0.1);
}

.start-screen__eyebrow {
    font-size: 12px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: #24536a;
    opacity: 0.98;
    margin-bottom: 8px;
    text-align: center;
}

.start-screen__title {
    margin: 0;
    font-size: 38px;
    line-height: 1.1;
    text-align: center;
    color: #0f3348;
    text-shadow: none;
}

.start-screen__text {
    margin: 12px 0 0;
    text-align: center;
    color: #1d4c63;
    opacity: 1;
}

.start-screen__actions {
    margin-top: 20px;
    display: grid;
    gap: 10px;
}

.start-screen__btn {
    border-radius: 14px !important;
    font-weight: 700;
    letter-spacing: 0.2px;
}

.start-screen__btn--daily {
    background: linear-gradient(150deg, #7bd7ee, #2b93bf) !important;
    color: #0a3146 !important;
    border: none !important;
    box-shadow: 0 8px 24px rgba(43, 147, 191, 0.34);
}

.start-screen__btn--menu {
    color: #123c52 !important;
    border-color: rgba(21, 78, 104, 0.52) !important;
    background: rgba(255, 255, 255, 0.55) !important;
}

.start-screen__halo {
    position: absolute;
    width: 12px;
    height: 12px;
    border-radius: 999px;
    background: #c4efff;
    box-shadow:
        0 0 12px rgba(196, 239, 255, 0.95),
        0 0 24px rgba(196, 239, 255, 0.55);
    opacity: 0.9;
}

.start-screen__halo::before,
.start-screen__halo::after {
    content: '';
    position: absolute;
    background: #c4efff;
    opacity: 0.8;
}

.start-screen__halo::before {
    width: 24px;
    height: 2px;
    top: 5px;
    left: -6px;
}

.start-screen__halo::after {
    width: 2px;
    height: 24px;
    left: 5px;
    top: -6px;
}

.start-screen__halo--left {
    top: 52px;
    left: 4px;
}

.start-screen__halo--right {
    right: 6px;
    top: 170px;
}

/* Sudoku menu page */
.sudoku-menu-layout {
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 16px;
    box-sizing: border-box;
}

.sudoku-menu-card {
    width: min(92vw, 340px);
    display: grid;
    gap: 12px;
    text-align: center;
}

.sudoku-menu-subtitle {
    font-size: 13px;
    opacity: 0.72;
}

.sudoku-menu-last-played {
    font-size: 13px;
    opacity: 0.72;
    font-weight: 400;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.sudoku-menu-last-line {
    font-size: 13px;
    opacity: 0.72;
    font-weight: 400;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.sudoku-menu-section-title {
    font-weight: 700;
}

.sudoku-menu-section-title--offline {
    margin-top: 8px;
}

.sudoku-menu-difficulties {
    display: grid;
    gap: 8px;
}

/* Low-height responsive behavior for start + menu */
@media (max-height: 620px) {
    .start-screen {
        width: min(94vw, 700px);
    }

    .start-screen__card {
        border-radius: 20px;
        padding-top: 12px;
        padding-bottom: 12px;
    }

    .start-screen__logo {
        width: 84px;
        height: 84px;
        margin-bottom: 8px;
    }

    .start-screen__title {
        font-size: 30px;
    }

    .start-screen__text {
        margin-top: 8px;
        font-size: 14px;
    }

    .start-screen__actions {
        margin-top: 12px;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 8px;
    }

    .sudoku-menu-card {
        width: min(95vw, 520px);
        grid-template-columns: 1fr;
        row-gap: 10px;
        text-align: center;
        align-items: stretch;
    }

    .sudoku-menu-section-title--offline {
        margin-top: 0;
        text-align: center;
    }

    .sudoku-menu-difficulties {
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 8px;
    }
}

@media (max-height: 500px) {
    .start-screen__eyebrow {
        font-size: 10px;
        margin-bottom: 4px;
    }

    .start-screen__title {
        font-size: 24px;
    }

    .start-screen__text {
        font-size: 12px;
        margin-top: 6px;
    }

    .start-screen__actions {
        margin-top: 8px;
    }

    .sudoku-menu-layout {
        padding-top: 10px;
        padding-bottom: 10px;
    }

    .sudoku-menu-card {
        gap: 8px;
    }

    .sudoku-menu-subtitle {
        font-size: 12px;
    }
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* Friends: compact "last seen" label on narrow screens */
.last-seen-prefix-short {
    display: none;
}

@media (max-width: 480px) {
    .last-seen-prefix-full {
        display: none;
    }

    .last-seen-prefix-short {
        display: inline;
    }

    .friend-status-indicator {
        gap: 0 !important;
    }

    .friend-status-text {
        display: none;
    }

    .friend-status-dot {
        width: 9px !important;
        height: 9px !important;
    }
}

@media (max-width: 360px) {
    .last-seen-prefix-short {
        display: none;
    }
}

/* Friends + Leaderboard: keep top spacing coupled to navbar height */
.page[data-name="friends"] .page-content,
.page[data-name="leaderboard"] .page-content,
.page[data-name="sudoku-list"] .page-content {
    padding-top: calc(var(--app-bar-height-fluid) + env(safe-area-inset-top)) !important;
    transition: padding-top 240ms ease;
}

/* Keep the first content gap constant across all viewport heights */
.page[data-name="friends"] .page-content>.block-title:first-child,
.page[data-name="friends"] .page-content>.block:first-child,
.page[data-name="leaderboard"] .page-content>.block-title:first-child,
.page[data-name="leaderboard"] .page-content>.block:first-child,
.page[data-name="sudoku-list"] .page-content>.block-title:first-child,
.page[data-name="sudoku-list"] .page-content>.block:first-child {
    margin-top: 10px !important;
}

/* Sudoku list: slightly tighter first content offset under the top bar */
.page[data-name="sudoku-list"] .page-content>.block-title:first-child,
.page[data-name="sudoku-list"] .page-content>.block:first-child,
.page[data-name="sudoku-list"] .page-content>.list:first-child {
    margin-top: 6px !important;
}

/* Sudoku page: keep board visible for both narrow and short viewports */
.page[data-name="sudoku"] {
    --sudoku-grid-max-size: min(92vw, calc(100dvh - var(--app-bar-height-fluid) - 290px));
}

.page[data-name="sudoku"] .page-content {
    padding-top: calc(var(--app-bar-height-fluid) + env(safe-area-inset-top)) !important;
}

.page[data-name="sudoku"] .page-content>.block:first-child {
    margin-top: 8px !important;
}

.sudoku-meta {
    display: flex;
    justify-content: space-between;
    gap: 10px;
    flex-wrap: wrap;
}

.sudoku-meta__mode {
    font-weight: 700;
}

.sudoku-meta__status {
    opacity: 0.72;
}

.sudoku-actions {
    display: flex;
    gap: 8px;
    margin-top: 12px;
    flex-wrap: wrap;
}

@media (max-height: 700px) {
    .page[data-name="sudoku"] {
        --sudoku-grid-max-size: min(92vw, calc(100dvh - var(--app-bar-height-fluid) - 250px));
    }

    .sudoku-meta {
        gap: 8px;
        font-size: 13px;
    }

    .sudoku-actions {
        margin-top: 8px;
        gap: 6px;
    }
}

@media (max-height: 590px) {
    .page[data-name="sudoku"] {
        --sudoku-grid-max-size: min(92vw, calc(100dvh - var(--app-bar-height-fluid) - 210px));
    }

    .sudoku-meta {
        font-size: 12px;
    }

    .sudoku-meta__status {
        display: none;
    }

    .sudoku-actions-block {
        margin-top: 0 !important;
        margin-bottom: 6px !important;
    }
}

@media (max-height: 500px) {
    .page[data-name="sudoku"] {
        --sudoku-grid-max-size: min(94vw, calc(100dvh - (var(--app-bar-height-fluid) * 2) - 110px));
    }

    .sudoku-actions .button {
        min-height: 30px;
        font-size: 11px;
        padding-left: 10px;
        padding-right: 10px;
    }
}

/* Landscape/low-height Sudoku mode */
@media (orientation: landscape) and (max-height: 520px) {
    .page[data-name="sudoku"] {
        --sudoku-grid-max-size: min(96vw, calc(100dvh - (var(--app-bar-height-fluid) * 2) - 90px));
    }

    .page[data-name="sudoku"] .page-content {
        padding-top: calc(var(--app-bar-height-fluid) + env(safe-area-inset-top) - 8px) !important;
    }

    .page[data-name="sudoku"] .sudoku-meta {
        display: none !important;
    }

    .page[data-name="sudoku"] .sudoku-actions-block {
        margin-top: 8px !important;
        margin-bottom: 6px !important;
    }

    .page[data-name="sudoku"] .sudoku-actions {
        margin-top: 6px;
        gap: 6px;
    }

    .page[data-name="sudoku"] .sudoku-actions .button {
        min-height: 28px;
        height: 28px;
        font-size: 11px;
        padding-left: 8px;
        padding-right: 8px;
        border-radius: 10px;
    }

    .page[data-name="sudoku"] .sudoku-board-block {
        margin-top: 0 !important;
        margin-bottom: 6px !important;
    }

    .page[data-name="sudoku"] .sudoku-help-list {
        margin-bottom: 8px !important;
    }
}
